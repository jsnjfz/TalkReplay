## Summary

Updated `tasks.md` to reflect the current Next.js-based project status and align with the Agents Web App Specification. Added Milestone 0 (Spec Alignment & Decisions) and expanded Milestone 1 with sub-phases for UI & Interaction, Ingestion & Provider Setup, Quality Gates & Testing, and Packaging & Deployment. Marked completed items (shell, filters, theming, browser import, server ingestion, CI/Husky, Docker) and listed pending work (stats/settings routes, virtualization, accessibility, Storybook, commitlint, coverage threshold, image size measurement).

## Code Highlights

```text
Edited: tasks.md
- Added "Milestone 0 – Spec Alignment & Decisions"
- Added "1.B – UI & Interaction" checklist (many items marked done)
- Added "1.C – Ingestion & Provider Setup" checklist (done + Gemini pending)
- Added "1.D – Quality Gates, Hooks, Testing" (commitlint, pre-push, Storybook, Stylelint, coverage)
- Added "1.E – Packaging & Deployment" (image size, docs)
- Added Notes clarifying Next.js usage and env toggles

Referenced files reviewed (no code changes in them):
- src/app/chats/[id]/page.tsx
- src/components/layout/app-shell.tsx
- src/components/sidebar/chat-sidebar.tsx
- src/components/chats/chat-list.tsx
- src/components/chats/chat-detail.tsx
- src/components/ui/button.tsx
- src/components/ui/scroll-area.tsx
- src/components/theme/{theme-provider.tsx,theme-toggle.tsx}
- src/lib/session-loader/{client.ts,server.ts}
- src/lib/providers/{claude.ts,codex.ts}
- src/workers/parser.worker.ts
- src/lib/parsers.ts
- src/app/api/{sessions,projects}/route.ts
- Dockerfile, .dockerignore, .eslintrc.cjs, vitest.config.ts, tsconfig.json, .github/workflows/ci.yml, .husky/pre-commit
```

## Self-Tests

Commands to validate the current state (non-destructive):

```bash
# Lint and tests
pnpm lint
pnpm test:ci

# Local dev (Next.js)
pnpm dev -- --port 3002

# Build and run production locally
pnpm build
CLAUDE_ROOT="$HOME/.claude/projects" \
CODEX_ROOT="$HOME/.codex/sessions" \
NEXT_PUBLIC_CLAUDE_ROOT="$CLAUDE_ROOT" \
NEXT_PUBLIC_CODEX_ROOT="$CODEX_ROOT" \
pnpm start

# Docker build and run with host mounts
docker build -t talk-replay .
docker run \
  -p 3000:3000 \
  -e NEXT_PUBLIC_CLAUDE_ROOT=/app/data/claude \
  -e NEXT_PUBLIC_CODEX_ROOT=/app/data/codex \
  -e CLAUDE_ROOT=/app/data/claude \
  -e CODEX_ROOT=/app/data/codex \
  -v "$HOME/.claude/projects":/app/data/claude:ro \
  -v "$HOME/.codex/sessions":/app/data/codex:ro \
  talk-replay
```

Expected outcomes:

- Lint/test pass; build succeeds.
- Home shows chat list with filters; navigating to `/chats/<id>` shows detail view.
- Provider Setup dialog accepts absolute paths (basic validation) and persists.
- Import transcript via file selector adds parsed sessions to the list.

## Risks/Blockers & Follow-ups

- Spec vs. implementation: Frontend uses Next.js; Vite migration is optional. Capture decision in `docs/architecture.md`.
- Missing routes: `/stats` (use `/api/projects`) and `/settings` (surface provider config, theme/locale).
- Performance: No virtualization for large lists yet; add `@tanstack/react-virtual`.
- Quality gates: Conventional Commits not enforced; add commitlint + `commit-msg` hook. Stylelint not integrated.
- Coverage: Add thresholds and backfill tests to reach ≥80%.
- Docker image size: Measure in CI; optimise if above target.

Timezone: UTC timestamps used in file naming.
